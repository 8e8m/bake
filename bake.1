.TH BAKE "1" "December 2025" "bake 20251213" "User Commands"
.SH NAME
.B bake
\- file embeddable scripts
.SH SYNOPSIS
.B bake
[\-chlnx] [\-s <N>] <FILENAME> [ARGS...]
.SH DESCRIPTION

bake is a simple tool meant to execute embedded shell commands within
any file. It executes with /bin/sh the command after a "\fB@BAKE\fP
" to the end of the line (a UNIX newline: '\fB\\n\fP') or to the first
instance of @STOP. All @BAKE ... @STOP statements must become before
any @BAKE ... EOLs.

This format may be embedded within \fBany file\fP.

It roots the shell execution in the directory of the given file.

Options must always be put before the filename, and short options may be merged together, numerical options must be trailing.

.HP
 \-h \-\-help, Help message
 \fB\-n \-\-dry\-run\fP, don't execute or remove anything
 \fB\-l \-\-list\fP, lists available bake blocks
 \fB\-q \-\-quiet\fP, Mutes all stderr output from bake itself, does not effect execution output in any way
 \fB\-s \-\-select\fP \<n\>, selects Nth bake block
 \fB\-x \-\-expunge\fP, Removes file specified in the expunge block
.PP
Macros

All macros can be exempted by prefixing them with a backslash,
which'll be subtracted in the expansion. backslashes may be used to
extend a command over several lines.

These macros will expand to their counterpart before execution.
.TP
.B @FILE, $@
returns target\-file (abc.x.txt)
.TP
.B @SHORT[:N], $*
returns target\-file without suffix (abc.x.txt \-> abc.x)
supports choice syntax, @SHORT:N removes N suffixes, so (a.b.c 2 -> a)
.TP
.B @ARGS[:N], $+
returns \fBarguments\fP, supports choice syntax: @ARGS:N prints the
Nth argument starting from 0, leading plus prints inclusive remaining
arguments (@ARGS:N+)
.TP
.B @LINE
returns the line number
.TP
.B @RECURS[:N]
returns full executable name (e.g. /usr/local/bin/bake)
.EX
@RECURS -s N = @RECURS:N
.EE
.TP
.B @RECUR:N
This is a specialized for one purpose, and should be ignored in general.
returns full executable name and the filename, also silences bake.
(e.g. /usr/local/bin/bake @FILE)
.EX
@RECURS:N -q @FILE = @RECUR:N
.EE
.TP
.B @CC
This is a specialized for one purpose, and should be ignored in general.
You might have to use recursion to properly phrase CC commands with this.
.EX
@CC = cc @ARGS:0 -o @SHORT @FILE @ARGS:1
@CC:/path/to/cc = /path/to/cc @ARGS:0 -o @SHORT @FILE @ARGS:1

Example recursion:
@BAKE @RECUR:2 "left" "right"
@BAKE @CC
.EE

.PP
Additional Features And Notes

Use NO_COLOR=1 to disable color.

Shell execution may be disabled with the \fB-n\fP or \fB--dry-run\fP option.

Expunge removes exactly one file specified in the @{FILENAME} format,
and the action is nonrecursive. Expunge simply outputs rm 'FILENAME...',
where the FILENAME expands any instance of ' to \e'.

If NO_COLOR is defined in the environment colors will not be implemented. https://no-color.org/

.PP
Other Implementations (NONDEFAULT)

Shake - Bash based, The modified version includes all features with
the exceptions of multi-line (as in to @STOP), select, and usable expunge.

Awake - AWK based, does not support multi-line (as in to @STOP), expunge,
parses options after filename, color, or changing directory to file's
directory - it's compatible with Bake otherwise.

.SH EXAMPLE

.\" SRC BEGIN (example.c)
.EX
// example.c @BAKE cc -o @SHORT @FILE @ARGS
#include <stdio.h>
int main (void) {
    puts("Hello.");
	return 0;
}
.EE
.SH COPYRIGHT
.PP
Licensed under the CC0-1.0.
